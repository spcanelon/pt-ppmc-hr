[
  {
    "objectID": "01_data_cleaning.html",
    "href": "01_data_cleaning.html",
    "title": "Data cleaning",
    "section": "",
    "text": "Code# install XLConnect\n# remotes::install_github(\"miraisolutions/xlconnect\")\n\n# install Java: https://www.timsanteford.com/posts/how-to-install-java-on-macos-using-homebrew/\n\n# src: https://stackoverflow.com/a/54827489\n\n# necessary for XLConnect\noptions(java.parameters = c(\"-XX:+UseConcMarkSweepGC\", \"-Xmx8192m\")) # set Java limit\ngc() # garbage collection (for use here and after each change in the excel workbook object)\n\npacman::p_load(\"janitor\",\n               \"readr\",\n               \"dplyr\",\n               \"lubridate\",\n               \"stringr\",\n               \"labelled\",\n               \"gtsummary\",\n               \"XLConnect\",\n               \"sf\",\n               \"rdeck\")\n\ntheme_gtsummary_compact()\nCode# source(here::here(\"R\", \"helper_functions.R\"))\nCode# HR data ----\nfile &lt;- here::here(\"data_raw\", \"ppmc_ee_20251219.xlsx\")\nfile_annotated &lt;- here::here(\"data_raw\", \"ppmc_ee_20251219_annotated.xlsx\")\npassword &lt;- keyring::key_get(\"ppmc-ee\")\n\nwb &lt;- loadWorkbook(filename = file_annotated, password = password)\n\n# List available sheets (to confirm sheet names)\nsheets &lt;- getSheets(wb)\n# print(sheets)  # Output: e.g., \"ALL EE \", \"DB_Pension\"\n \n# Read a specific sheet (e.g., \"ALL EE\")\ndata_all_ee &lt;- readWorksheet(wb, sheet = \"ALL EE \", startRow = 1, header = TRUE) |&gt; clean_names()\ndata_db_pension &lt;- readWorksheet(wb, sheet = \"DB_Pension\", startRow = 1, header = TRUE) |&gt; clean_names()\ndata_dc_403b &lt;- readWorksheet(wb, sheet = \"DC_403b Retirement\", startRow = 1, header = TRUE) |&gt; clean_names()\ndata_retirement_loans &lt;- readWorksheet(wb, sheet = \"Retirement Loans\", startRow = 1, header = TRUE)\n# # --- hidden data\n# data_loa_wc_nosal &lt;- readWorksheet(wb, sheet = \"LOA_WC_No Sal Data\", startRow = 1, header = TRUE) |&gt; clean_names()\n# data_roster &lt;- readWorksheet(wb, sheet = \"Roster\", startRow = 1, header = TRUE) |&gt; clean_names()\n# # --- hidden data\ngc()\n\n# zip codes ----\nboxDrive &lt;- here::here(\"/Users/scanelon/Library/CloudStorage/Box-Box\", \"Green-Geobirth R01\", \"3. Data-related (nonPHI)\", \"Data_Spatial\")\n\nzips &lt;-\n  st_read(paste(boxDrive,\n                \"data_intermediate\",\n                \"spatial_layers\",\n                \"Open Data Philly\",\n                \"City_Boundaries\",\n                \"Zipcodes_Poly.gpkg\",\n                sep = \"/\"))\nCode# summarytools::view(\n#   summarytools::dfSummary(data_all_ee,\n#                           col.widths = c(100, 100, 200, 100, 100, 100, 100))\n#   )\n\nsummarytools::dfSummary(\n  data_all_ee,\n  plain.ascii  = FALSE, \n  style        = \"grid\", \n  graph.magnif = 0.82, \n  varnumbers   = FALSE,\n  valid.col    = FALSE,\n  tmp.img.dir  = \"/tmp\"\n)\nCodedata_all_ee &lt;-\n  data_all_ee |&gt; \n  set_variable_labels(\n    fte = \"FTE\",\n    annual_salary = \"Annual salary\",\n    race_ethnicity = \"Race/ethnicity\",\n    gender = \"Gender\",\n    job_category = \"Job category\",\n    sub_category = \"Job sub category\",\n    work_location = \"Work location\",\n    work_zip_code = \"Work zip code\",\n    state = \"State\",\n    zip_code = \"Employee zip code\"\n  )\n\ndata_ee_trim &lt;-\n  data_all_ee |&gt; \n  select(ee_id, fte, annual_salary, race_ethnicity, gender,\n         job_category, sub_category, work_location, work_zip_code,\n         state, zip_code)",
    "crumbs": [
      "Project",
      "Data cleaning"
    ]
  },
  {
    "objectID": "01_data_cleaning.html#salary-category",
    "href": "01_data_cleaning.html#salary-category",
    "title": "Data cleaning",
    "section": "Salary category",
    "text": "Salary category\n\nCodedata_ee_trim &lt;-\n  data_ee_trim |&gt;\n  mutate(annual_salary_category = case_when(\n    annual_salary &lt; 62000 ~ \"Less than 62k\",\n    annual_salary &gt;= 62000 & annual_salary &lt; 100000 ~ \"62k-100k\",\n    annual_salary &gt;= 100000 & annual_salary &lt; 150000 ~ \"100k-150k\",\n    annual_salary &gt;= 150000 & annual_salary &lt; 200000 ~ \"150k-200k\",\n    annual_salary &gt;= 200000 ~ \"More than 200k\"\n  )) |&gt; \n  mutate(annual_salary_category = factor(annual_salary_category,\n                                         levels = c(\"Less than 62k\",\n                                                    \"62k-100k\",\n                                                    \"100k-150k\",\n                                                    \"150k-200k\",\n                                                    \"More than 200k\"))) |&gt; \n  set_variable_labels(annual_salary_category = \"Annual salary category\")\n\n\n\nCodetbl_summary(data_ee_trim,\n            include = c(race_ethnicity,\n                        fte,\n                        gender,\n                        # job_category,\n                        annual_salary_category),\n            by = annual_salary_category,\n            type = all_continuous() ~ \"continuous2\",\n            statistic = all_continuous() ~ c(\n              \"{mean} ({sd})\",\n              \"{median}\",\n              \"{min}-{max}\"\n            ),\n            sort = list(c(gender) ~ \"alphanumeric\")) |&gt; \n  add_overall() |&gt; \n  bold_labels() |&gt; \n  modify_header(all_stat_cols() ~ \"**{level}**&lt;br&gt;N = {n} ({style_percent(p)}%)\") |&gt;\n  as_gt() %&gt;%\n  gt::cols_width(\n    label ~ px(220),\n    everything() ~ px(110)\n  ) |&gt; \n  gt::tab_header(title = \"Employee Salary\") |&gt; \n  gt::opt_table_font(font = \"Avenir\", \n                     stack = \"rounded-sans\")\n\n\n\n\n\n\nEmployee Salary\n\n\nCharacteristic\n\nOverallN = 3094 (100%)1\n\n\nLess than 62kN = 1269 (41%)1\n\n\n62k-100kN = 402 (13%)1\n\n\n100k-150kN = 1305 (42%)1\n\n\n150k-200kN = 111 (3.6%)1\n\n\nMore than 200kN = 7 (0.2%)1\n\n\n\n\n\nRace/ethnicity\n\n\n\n\n\n\n\n\n    Amer Ind/Alask Ntv not His/Lat\n2 (0.2%)\n1 (0.2%)\n0 (0%)\n1 (0.3%)\n0 (0%)\n0 (0%)\n\n\n    Asian not Hispanic/Latino\n301 (32%)\n93 (20%)\n37 (33%)\n154 (45%)\n14 (67%)\n3 (75%)\n\n\n    Black/African Amer not His/Lat\n297 (31%)\n206 (44%)\n38 (34%)\n49 (14%)\n3 (14%)\n1 (25%)\n\n\n    Hispanic or Latino\n151 (16%)\n75 (16%)\n19 (17%)\n56 (16%)\n1 (4.8%)\n0 (0%)\n\n\n    Ntv Hawaii/Pac Isl not His/Lat\n4 (0.4%)\n2 (0.4%)\n1 (0.9%)\n1 (0.3%)\n0 (0%)\n0 (0%)\n\n\n    Two or More Races not Hisp/Lat\n88 (9.3%)\n44 (9.5%)\n8 (7.2%)\n36 (10%)\n0 (0%)\n0 (0%)\n\n\n    Undeclared\n49 (5.2%)\n28 (6.0%)\n1 (0.9%)\n18 (5.2%)\n2 (9.5%)\n0 (0%)\n\n\n    White not Hispanic/Latino\n53 (5.6%)\n15 (3.2%)\n7 (6.3%)\n30 (8.7%)\n1 (4.8%)\n0 (0%)\n\n\n    Unknown\n2,149\n805\n291\n960\n90\n3\n\n\nFTE\n\n\n\n\n\n\n\n\n    Mean (SD)\n0.77 (0.35)\n0.56 (0.45)\n0.85 (0.19)\n0.94 (0.06)\n1.00 (0.01)\n1.00 (0.00)\n\n\n    Median\n0.90\n0.89\n0.90\n0.90\n1.00\n1.00\n\n\n    Min-Max\n0.01-1.01\n0.01-1.00\n0.50-1.01\n0.01-1.00\n0.90-1.01\n1.00-1.00\n\n\nGender\n\n\n\n\n\n\n\n\n    F\n2,427 (78%)\n979 (77%)\n332 (83%)\n1,021 (78%)\n91 (82%)\n4 (57%)\n\n\n    M\n651 (21%)\n282 (22%)\n69 (17%)\n277 (21%)\n20 (18%)\n3 (43%)\n\n\n    O\n1 (&lt;0.1%)\n1 (&lt;0.1%)\n0 (0%)\n0 (0%)\n0 (0%)\n0 (0%)\n\n\n    W\n15 (0.5%)\n7 (0.6%)\n1 (0.2%)\n7 (0.5%)\n0 (0%)\n0 (0%)\n\n\n\n\n1 n (%)",
    "crumbs": [
      "Project",
      "Data cleaning"
    ]
  },
  {
    "objectID": "01_data_cleaning.html#job-category-and-subcategory",
    "href": "01_data_cleaning.html#job-category-and-subcategory",
    "title": "Data cleaning",
    "section": "Job category and subcategory",
    "text": "Job category and subcategory\n\nCode# DO NOT USE: sub_category and job_category do not nest approrpriately ----\n# tbl_job &lt;-\n#   tbl_strata_nested_stack(\n#   data_ee_trim,\n#   strata = job_category,\n#   .tbl_fun = ~ .x |&gt;\n#     tbl_summary(#data = data_ee_trim,\n#                 include = c(#job_category,\n#                             sub_category,\n#                             annual_salary_category),\n#                 by = annual_salary_category,\n#                 percent = \"column\") |&gt; \n#     # add_overall() |&gt;\n#     # replace 0 (0%) and 0 (NA %) with em dash\n#     # src: https://github.com/ddsjoberg/gtsummary/issues/2153#issuecomment-2664253147\n#     modify_table_body(\n#     ~ .x |&gt;\n#       mutate(across(all_stat_cols(), ~ ifelse(. %in% c(\"0 (0%)\" ,\"0 (NA%)\", \"NA (NA, NA)\"), NA, .)))\n#   ) |&gt;\n#   modify_missing_symbol(\n#     symbol = \"---\", # converts to an em-dash\n#     columns = all_stat_cols(),\n#     rows =\n#       (var_type %in% c(\"continuous\", \"dichotomous\") & row_type == \"label\") |\n#       (var_type %in% c(\"continuous2\", \"categorical\") & row_type == \"level\")\n#   ),\n#   row_header = \"{strata}, n = {n}, N = {N}\"\n# ) |&gt;\n#   modify_header(all_stat_cols() ~ \"**{level}**\") |&gt;\n#   modify_bold(columns = \"label\", rows = tbl_indent_id1 &gt; 0) |&gt;\n#   modify_caption(\"Job category/subcategory by salary\")\n# tbl_job\n# ----\n\nsummary_job_income &lt;- \n  data_ee_trim |&gt; \n  group_by(job_category) |&gt; \n  mutate(n_job_category = n_distinct(ee_id)) |&gt; \n  group_by(job_category, n_job_category, sub_category) |&gt; \n  mutate(n_sub_category = n_distinct(ee_id),\n         prop_sub_category = n_sub_category/n_job_category) |&gt; \n  group_by(job_category, n_job_category, sub_category, \n           n_sub_category, prop_sub_category, annual_salary_category) |&gt; \n  summarize(n_salary_category = n_distinct(ee_id),\n            prop_salary_category = n_salary_category/n_job_category) |&gt;\n  unique() |&gt; \n  ungroup() |&gt; \n  # convert to uppercase so sorting alphabetically ignores case\n  arrange(str_to_upper(job_category)) |&gt; \n  tidyr::pivot_wider(names_from = annual_salary_category,\n                     values_from = c(n_salary_category, prop_salary_category),\n                     names_glue = \"{.value}_{annual_salary_category}\") |&gt; \n  clean_names()\n\n\n\nCode# gt ----\nsummary_job_income |&gt;\n  group_by(job_category) |&gt; \n  gt::gt() |&gt; \n  gt::cols_hide(n_job_category) |&gt; \n  gt::fmt_percent(\n    columns = tidyselect::contains(\"prop\"),\n    decimals = 1,\n    pattern = \"({x})\"\n  ) |&gt; \n  gt::summary_rows(\n    groups = everything(),\n    columns = tidyselect::starts_with(\"n_\"),\n    fns = list(\"Total, job category\" ~ sum(., na.rm = TRUE)),\n    fmt = ~ fmt_number(., decimals = 0),\n    side = \"top\"\n  ) |&gt;\n  gt::summary_rows(\n    groups = everything(),\n    columns = tidyselect::starts_with(\"prop_\"),\n    fns = list(\"Total, job category\" ~ sum(., na.rm = TRUE)),\n    fmt = ~ fmt_percent(., decimals = 1, pattern = \"({x})\"),\n    side = \"top\"\n  ) |&gt;\n  gt::grand_summary_rows(\n    columns = tidyselect::starts_with(\"n_\"),\n    fns = list(\"Total, N\" ~ sum(., na.rm = TRUE)),\n    fmt = ~ fmt_number(., decimals = 0, use_seps = FALSE)\n  ) |&gt;\n  gt::tab_spanner(\n    columns = c(n_sub_category, prop_sub_category),\n    label = gt::md(\"Overall\")\n  ) |&gt; \n  gt::tab_spanner(\n    columns = tidyselect::contains(\"less_than_62k\"),\n    label = gt::md(\"Less than 62k\")\n  ) |&gt; \n    gt::tab_spanner(\n    columns = tidyselect::contains(\"62k_100k\"),\n    label = gt::md(\"62k-100k\")\n  ) |&gt; \n  gt::tab_spanner(\n    columns = tidyselect::contains(\"100k_150k\"),\n    label = gt::md(\"100k-150k\")\n  ) |&gt; \n  gt::tab_spanner(\n    columns = tidyselect::contains(\"150k_200k\"),\n    label = gt::md(\"150k-200k\")\n  ) |&gt; \n  gt::tab_spanner(\n    columns = tidyselect::contains(\"more_than_200k\"),\n    label = gt::md(\"More than 200k\")\n  ) |&gt; \n  gt::sub_missing(\n    columns = everything(),\n    rows = everything(),\n    missing_text = \"---\"\n  ) |&gt; \n  gt::tab_style(\n    style = gt::cell_text(weight = \"bold\"),\n    locations = list(gt::cells_row_groups(),\n                     gt::cells_column_spanners(),\n                     gt::cells_column_labels(sub_category))\n  ) |&gt; \n  gt::cols_label(\n    starts_with(\"n_\") ~ \"n\",\n    starts_with(\"prop_\") ~ \"(%)\"\n  ) |&gt;\n  gt::cols_width(\n    sub_category ~ px(260),\n    everything() ~ px(80)\n  ) |&gt; \n  gt::tab_header(\n    title = \"Job category / sub category by salary category\"\n  ) |&gt; \n  gt::opt_vertical_padding(scale = 0.2) |&gt; \n  gt::opt_table_font(font = \"Avenir\", \n                     stack = \"rounded-sans\")\n\n\n\n\n\n\nJob category / sub category by salary category\n\n\n\nJob sub category\n\nOverall\n\n\nLess than 62k\n\n\n62k-100k\n\n\n100k-150k\n\n\n150k-200k\n\n\nMore than 200k\n\n\n\nn\n(%)\nn\n(%)\nn\n(%)\nn\n(%)\nn\n(%)\nn\n(%)\n\n\n\n\nAccess\n\n\nTotal, job category\n—\n94\n(100.0%)\n92\n(97.9%)\n2\n(2.1%)\n0\n(0.0%)\n0\n(0.0%)\n0\n(0.0%)\n\n\n\nPatient Access\n52\n(55.3%)\n51\n(54.3%)\n1\n(1.1%)\n—\n—\n—\n—\n—\n—\n\n\n\nPatient Access NoHVB\n42\n(44.7%)\n41\n(43.6%)\n1\n(1.1%)\n—\n—\n—\n—\n—\n—\n\n\nAH Cardiology\n\n\nTotal, job category\n—\n50\n(100.0%)\n16\n(32.0%)\n13\n(26.0%)\n8\n(16.0%)\n9\n(18.0%)\n4\n(8.0%)\n\n\n\nCath Lab Cardiac\n19\n(38.0%)\n9\n(18.0%)\n9\n(18.0%)\n1\n(2.0%)\n—\n—\n—\n—\n\n\n\nEchocardiogram Technician\n13\n(26.0%)\n4\n(8.0%)\n3\n(6.0%)\n6\n(12.0%)\n—\n—\n—\n—\n\n\n\nOR Technicians Perfusion\n2\n(4.0%)\n2\n(4.0%)\n—\n—\n—\n—\n—\n—\n—\n—\n\n\n\nPerfusionist\n16\n(32.0%)\n1\n(2.0%)\n1\n(2.0%)\n1\n(2.0%)\n9\n(18.0%)\n4\n(8.0%)\n\n\nAH Lab-Path Technologist\n\n\nTotal, job category\n—\n43\n(100.0%)\n15\n(34.9%)\n25\n(58.1%)\n3\n(7.0%)\n0\n(0.0%)\n0\n(0.0%)\n\n\n\nMedical Technologist MT\n38\n(88.4%)\n13\n(30.2%)\n25\n(58.1%)\n—\n—\n—\n—\n—\n—\n\n\n\nPathology Asst\n5\n(11.6%)\n2\n(4.7%)\n—\n—\n3\n(7.0%)\n—\n—\n—\n—\n\n\nAH Pharmacist\n\n\nTotal, job category\n—\n107\n(100.0%)\n20\n(18.7%)\n3\n(2.8%)\n70\n(65.4%)\n14\n(13.1%)\n0\n(0.0%)\n\n\n\nPharmacist RP\n107\n(100.0%)\n20\n(18.7%)\n3\n(2.8%)\n70\n(65.4%)\n14\n(13.1%)\n—\n—\n\n\nAH PT OT SP Therapist\n\n\nTotal, job category\n—\n1\n(100.0%)\n0\n(0.0%)\n1\n(100.0%)\n0\n(0.0%)\n0\n(0.0%)\n0\n(0.0%)\n\n\n\nRecreation Therapist\n1\n(100.0%)\n—\n—\n1\n(100.0%)\n—\n—\n—\n—\n—\n—\n\n\nAH Rad-Onc Cancer Professional\n\n\nTotal, job category\n—\n2\n(100.0%)\n0\n(0.0%)\n0\n(0.0%)\n0\n(0.0%)\n2\n(100.0%)\n0\n(0.0%)\n\n\n\nDosimetrist\n2\n(100.0%)\n—\n—\n—\n—\n—\n—\n2\n(100.0%)\n—\n—\n\n\nAH Radiology Technologist-Diag\n\n\nTotal, job category\n—\n45\n(100.0%)\n22\n(48.9%)\n6\n(13.3%)\n17\n(37.8%)\n0\n(0.0%)\n0\n(0.0%)\n\n\n\nRadiology Tchnlst RT Dgnstc\n45\n(100.0%)\n22\n(48.9%)\n6\n(13.3%)\n17\n(37.8%)\n—\n—\n—\n—\n\n\nAH Radiology Technologist-Spec\n\n\nTotal, job category\n—\n49\n(100.0%)\n13\n(26.5%)\n0\n(0.0%)\n35\n(71.4%)\n1\n(2.0%)\n0\n(0.0%)\n\n\n\nCT Technologist\n13\n(26.5%)\n5\n(10.2%)\n—\n—\n8\n(16.3%)\n—\n—\n—\n—\n\n\n\nCrdc Nclr Medicine Tchnlst NMT\n2\n(4.1%)\n1\n(2.0%)\n—\n—\n1\n(2.0%)\n—\n—\n—\n—\n\n\n\nIntrvnl Rdlgy Tchnlst\n7\n(14.3%)\n—\n—\n—\n—\n7\n(14.3%)\n—\n—\n—\n—\n\n\n\nMRI Technologist\n9\n(18.4%)\n1\n(2.0%)\n—\n—\n8\n(16.3%)\n—\n—\n—\n—\n\n\n\nRadiation Tchnlst RT Thrpy\n9\n(18.4%)\n3\n(6.1%)\n—\n—\n5\n(10.2%)\n1\n(2.0%)\n—\n—\n\n\n\nRadiology Tchnlst RT Spec\n1\n(2.0%)\n—\n—\n—\n—\n1\n(2.0%)\n—\n—\n—\n—\n\n\n\nUltrasound Technologist\n8\n(16.3%)\n3\n(6.1%)\n—\n—\n5\n(10.2%)\n—\n—\n—\n—\n\n\nAH Respiratory\n\n\nTotal, job category\n—\n62\n(100.0%)\n15\n(24.2%)\n13\n(21.0%)\n34\n(54.8%)\n0\n(0.0%)\n0\n(0.0%)\n\n\n\nCrtfd Respiratory Thrpy Tchn\n1\n(1.6%)\n—\n—\n1\n(1.6%)\n—\n—\n—\n—\n—\n—\n\n\n\nRespiratory Therapist YM\n58\n(93.5%)\n15\n(24.2%)\n12\n(19.4%)\n31\n(50.0%)\n—\n—\n—\n—\n\n\n\nRespiratory Thrpy Tchn\n3\n(4.8%)\n—\n—\n—\n—\n3\n(4.8%)\n—\n—\n—\n—\n\n\nClerical and Other\n\n\nTotal, job category\n—\n87\n(100.0%)\n77\n(88.5%)\n10\n(11.5%)\n0\n(0.0%)\n0\n(0.0%)\n0\n(0.0%)\n\n\n\nClerical Coord or Supr\n1\n(1.1%)\n—\n—\n1\n(1.1%)\n—\n—\n—\n—\n—\n—\n\n\n\nClerical Coord or Supr HVB\n1\n(1.1%)\n—\n—\n1\n(1.1%)\n—\n—\n—\n—\n—\n—\n\n\n\nClerical Worker\n74\n(85.1%)\n66\n(75.9%)\n8\n(9.2%)\n—\n—\n—\n—\n—\n—\n\n\n\nClerical Worker NPC\n5\n(5.7%)\n5\n(5.7%)\n—\n—\n—\n—\n—\n—\n—\n—\n\n\n\nOther Trainee\n6\n(6.9%)\n6\n(6.9%)\n—\n—\n—\n—\n—\n—\n—\n—\n\n\nManagement Middle and Upper\n\n\nTotal, job category\n—\n27\n(100.0%)\n0\n(0.0%)\n13\n(48.1%)\n10\n(37.0%)\n4\n(14.8%)\n0\n(0.0%)\n\n\n\nLaboratory Mgmt No Pt Care\n1\n(3.7%)\n—\n—\n—\n—\n1\n(3.7%)\n—\n—\n—\n—\n\n\n\nMgmt Other Mgmt\n19\n(70.4%)\n—\n—\n7\n(25.9%)\n8\n(29.6%)\n4\n(14.8%)\n—\n—\n\n\n\nMgmt Other Mgmt HVB\n2\n(7.4%)\n—\n—\n2\n(7.4%)\n—\n—\n—\n—\n—\n—\n\n\n\nMgmt Other Mgmt NoHVB\n3\n(11.1%)\n—\n—\n3\n(11.1%)\n—\n—\n—\n—\n—\n—\n\n\n\nPharmacy Mgmt\n1\n(3.7%)\n—\n—\n—\n—\n1\n(3.7%)\n—\n—\n—\n—\n\n\n\nSecurity Mgmt\n1\n(3.7%)\n—\n—\n1\n(3.7%)\n—\n—\n—\n—\n—\n—\n\n\nManagement Nurse Manager\n\n\nTotal, job category\n—\n23\n(100.0%)\n0\n(0.0%)\n0\n(0.0%)\n3\n(13.0%)\n20\n(87.0%)\n0\n(0.0%)\n\n\n\nRN Indirect Manager\n23\n(100.0%)\n—\n—\n—\n—\n3\n(13.0%)\n20\n(87.0%)\n—\n—\n\n\nManagement Nursing\n\n\nTotal, job category\n—\n22\n(100.0%)\n0\n(0.0%)\n0\n(0.0%)\n14\n(63.6%)\n8\n(36.4%)\n0\n(0.0%)\n\n\n\nMgmt RN Adv Pract\n8\n(36.4%)\n—\n—\n—\n—\n—\n—\n8\n(36.4%)\n—\n—\n\n\n\nNurse Mgmt Mid Lvl CNO Struct\n6\n(27.3%)\n—\n—\n—\n—\n6\n(27.3%)\n—\n—\n—\n—\n\n\n\nNurse Mgmt Supr Lvl CNO Struct\n8\n(36.4%)\n—\n—\n—\n—\n8\n(36.4%)\n—\n—\n—\n—\n\n\nManagement Supervisor\n\n\nTotal, job category\n—\n41\n(100.0%)\n1\n(2.4%)\n18\n(43.9%)\n15\n(36.6%)\n7\n(17.1%)\n0\n(0.0%)\n\n\n\nFinance Mgmt Supr\n1\n(2.4%)\n—\n—\n—\n—\n1\n(2.4%)\n—\n—\n—\n—\n\n\n\nIntvn Cardiac Cath Nurses Supr\n1\n(2.4%)\n—\n—\n—\n—\n1\n(2.4%)\n—\n—\n—\n—\n\n\n\nLaboratory Mgmt Supr\n6\n(14.6%)\n—\n—\n1\n(2.4%)\n5\n(12.2%)\n—\n—\n—\n—\n\n\n\nMgmt Other Mgmt Supr\n18\n(43.9%)\n1\n(2.4%)\n17\n(41.5%)\n—\n—\n—\n—\n—\n—\n\n\n\nPharmacy Mgmt Supr\n7\n(17.1%)\n—\n—\n—\n—\n1\n(2.4%)\n6\n(14.6%)\n—\n—\n\n\n\nRadiology Mgmt Supr\n5\n(12.2%)\n—\n—\n—\n—\n4\n(9.8%)\n1\n(2.4%)\n—\n—\n\n\n\nRespiratory Mgmt Supr\n2\n(4.9%)\n—\n—\n—\n—\n2\n(4.9%)\n—\n—\n—\n—\n\n\n\nSocial Work Mgmt Supr\n1\n(2.4%)\n—\n—\n—\n—\n1\n(2.4%)\n—\n—\n—\n—\n\n\nNursing Advanced Practice\n\n\nTotal, job category\n—\n163\n(100.0%)\n12\n(7.4%)\n10\n(6.1%)\n93\n(57.1%)\n45\n(27.6%)\n3\n(1.8%)\n\n\n\nNurse Practitioner\n87\n(53.4%)\n9\n(5.5%)\n8\n(4.9%)\n45\n(27.6%)\n25\n(15.3%)\n—\n—\n\n\n\nPhysician Assistant MD Office\n1\n(0.6%)\n—\n—\n—\n—\n—\n—\n—\n—\n1\n(0.6%)\n\n\n\nPhysician Assistant PA\n71\n(43.6%)\n3\n(1.8%)\n2\n(1.2%)\n44\n(27.0%)\n20\n(12.3%)\n2\n(1.2%)\n\n\n\nRN Direct Clinical Specialist\n4\n(2.5%)\n—\n—\n—\n—\n4\n(2.5%)\n—\n—\n—\n—\n\n\nNursing RN Direct Pt Care\n\n\nTotal, job category\n—\n1,229\n(100.0%)\n130\n(10.6%)\n199\n(16.2%)\n900\n(73.2%)\n0\n(0.0%)\n0\n(0.0%)\n\n\n\nRN Direct Bedside\n1128\n(91.8%)\n124\n(10.1%)\n111\n(9.0%)\n893\n(72.7%)\n—\n—\n—\n—\n\n\n\nRN Direct Grad Nurse Bedside\n87\n(7.1%)\n—\n—\n87\n(7.1%)\n—\n—\n—\n—\n—\n—\n\n\n\nRN Direct Pt Care Other\n5\n(0.4%)\n1\n(0.1%)\n—\n—\n4\n(0.3%)\n—\n—\n—\n—\n\n\n\nRN DirectOutpatient Ambulatory\n9\n(0.7%)\n5\n(0.4%)\n1\n(0.1%)\n3\n(0.2%)\n—\n—\n—\n—\n\n\nNursing RN Indirect Pt Care\n\n\nTotal, job category\n—\n79\n(100.0%)\n8\n(10.1%)\n3\n(3.8%)\n67\n(84.8%)\n1\n(1.3%)\n0\n(0.0%)\n\n\n\nRN Indirect PT Care HVB\n32\n(40.5%)\n8\n(10.1%)\n—\n—\n24\n(30.4%)\n—\n—\n—\n—\n\n\n\nRN Indirect Pt Care\n47\n(59.5%)\n—\n—\n3\n(3.8%)\n43\n(54.4%)\n1\n(1.3%)\n—\n—\n\n\nNursing RN MD Office\n\n\nTotal, job category\n—\n43\n(100.0%)\n12\n(27.9%)\n3\n(7.0%)\n28\n(65.1%)\n0\n(0.0%)\n0\n(0.0%)\n\n\n\nRN Direct MD Office\n43\n(100.0%)\n12\n(27.9%)\n3\n(7.0%)\n28\n(65.1%)\n—\n—\n—\n—\n\n\nNursing Support\n\n\nTotal, job category\n—\n488\n(100.0%)\n485\n(99.4%)\n3\n(0.6%)\n0\n(0.0%)\n0\n(0.0%)\n0\n(0.0%)\n\n\n\nCert Nursing Assistant CNA\n235\n(48.2%)\n235\n(48.2%)\n—\n—\n—\n—\n—\n—\n—\n—\n\n\n\nMed Asst Drctd by Doc or RN MA\n35\n(7.2%)\n35\n(7.2%)\n—\n—\n—\n—\n—\n—\n—\n—\n\n\n\nNurse Student Extern Intern\n4\n(0.8%)\n4\n(0.8%)\n—\n—\n—\n—\n—\n—\n—\n—\n\n\n\nNursing Aide\n85\n(17.4%)\n85\n(17.4%)\n—\n—\n—\n—\n—\n—\n—\n—\n\n\n\nPatient Care Observer\n34\n(7.0%)\n34\n(7.0%)\n—\n—\n—\n—\n—\n—\n—\n—\n\n\n\nPeriOp Nursing Support\n2\n(0.4%)\n2\n(0.4%)\n—\n—\n—\n—\n—\n—\n—\n—\n\n\n\nPeriop Nursing Support\n11\n(2.3%)\n11\n(2.3%)\n—\n—\n—\n—\n—\n—\n—\n—\n\n\n\nPerioperative Assistant\n40\n(8.2%)\n39\n(8.0%)\n1\n(0.2%)\n—\n—\n—\n—\n—\n—\n\n\n\nPractical Nurse\n2\n(0.4%)\n—\n—\n2\n(0.4%)\n—\n—\n—\n—\n—\n—\n\n\n\nUnit Clerk Secretary\n40\n(8.2%)\n40\n(8.2%)\n—\n—\n—\n—\n—\n—\n—\n—\n\n\nProfessional Clinical\n\n\nTotal, job category\n—\n44\n(100.0%)\n16\n(36.4%)\n26\n(59.1%)\n2\n(4.5%)\n0\n(0.0%)\n0\n(0.0%)\n\n\n\nOther Health Professional HVB\n15\n(34.1%)\n7\n(15.9%)\n6\n(13.6%)\n2\n(4.5%)\n—\n—\n—\n—\n\n\n\nSocial Worker MS\n29\n(65.9%)\n9\n(20.5%)\n20\n(45.5%)\n—\n—\n—\n—\n—\n—\n\n\nProfessional Finance\n\n\nTotal, job category\n—\n4\n(100.0%)\n0\n(0.0%)\n4\n(100.0%)\n0\n(0.0%)\n0\n(0.0%)\n0\n(0.0%)\n\n\n\nCredit Billing Professionals\n3\n(75.0%)\n—\n—\n3\n(75.0%)\n—\n—\n—\n—\n—\n—\n\n\n\nFinance Professional\n1\n(25.0%)\n—\n—\n1\n(25.0%)\n—\n—\n—\n—\n—\n—\n\n\nProfessional Info Tech\n\n\nTotal, job category\n—\n1\n(100.0%)\n0\n(0.0%)\n1\n(100.0%)\n0\n(0.0%)\n0\n(0.0%)\n0\n(0.0%)\n\n\n\nIT Professional\n1\n(100.0%)\n—\n—\n1\n(100.0%)\n—\n—\n—\n—\n—\n—\n\n\nProfessional Other\n\n\nTotal, job category\n—\n24\n(100.0%)\n7\n(29.2%)\n12\n(50.0%)\n5\n(20.8%)\n0\n(0.0%)\n0\n(0.0%)\n\n\n\nAdministrative Prof NoHVB\n2\n(8.3%)\n—\n—\n2\n(8.3%)\n—\n—\n—\n—\n—\n—\n\n\n\nAdministrative Professional\n9\n(37.5%)\n2\n(8.3%)\n2\n(8.3%)\n5\n(20.8%)\n—\n—\n—\n—\n\n\n\nAdministrative Support ProfNPC\n3\n(12.5%)\n—\n—\n3\n(12.5%)\n—\n—\n—\n—\n—\n—\n\n\n\nMedical Record Coder Prof NPC\n6\n(25.0%)\n2\n(8.3%)\n4\n(16.7%)\n—\n—\n—\n—\n—\n—\n\n\n\nProf Support Workers NoHVB\n4\n(16.7%)\n3\n(12.5%)\n1\n(4.2%)\n—\n—\n—\n—\n—\n—\n\n\nService\n\n\nTotal, job category\n—\n37\n(100.0%)\n37\n(100.0%)\n0\n(0.0%)\n0\n(0.0%)\n0\n(0.0%)\n0\n(0.0%)\n\n\n\nService Worker\n28\n(75.7%)\n28\n(75.7%)\n—\n—\n—\n—\n—\n—\n—\n—\n\n\n\nService Worker HVB\n9\n(24.3%)\n9\n(24.3%)\n—\n—\n—\n—\n—\n—\n—\n—\n\n\nTechnician\n\n\nTotal, job category\n—\n329\n(100.0%)\n291\n(88.4%)\n37\n(11.2%)\n1\n(0.3%)\n0\n(0.0%)\n0\n(0.0%)\n\n\n\nCrtfd Ortho Prosthetics Tchn\n1\n(0.3%)\n1\n(0.3%)\n—\n—\n—\n—\n—\n—\n—\n—\n\n\n\nEEG EMG Technician\n3\n(0.9%)\n—\n—\n3\n(0.9%)\n—\n—\n—\n—\n—\n—\n\n\n\nEmergency Medical Tchn EMT\n54\n(16.4%)\n52\n(15.8%)\n2\n(0.6%)\n—\n—\n—\n—\n—\n—\n\n\n\nGI Technician\n8\n(2.4%)\n6\n(1.8%)\n2\n(0.6%)\n—\n—\n—\n—\n—\n—\n\n\n\nMedical Lab Tchns\n23\n(7.0%)\n17\n(5.2%)\n6\n(1.8%)\n—\n—\n—\n—\n—\n—\n\n\n\nMedical Technician\n1\n(0.3%)\n1\n(0.3%)\n—\n—\n—\n—\n—\n—\n—\n—\n\n\n\nOperating Room Technicians\n51\n(15.5%)\n30\n(9.1%)\n21\n(6.4%)\n—\n—\n—\n—\n—\n—\n\n\n\nOther Health Sprt OTJ Req HVB\n57\n(17.3%)\n55\n(16.7%)\n1\n(0.3%)\n1\n(0.3%)\n—\n—\n—\n—\n\n\n\nOther Technician Aide\n2\n(0.6%)\n1\n(0.3%)\n1\n(0.3%)\n—\n—\n—\n—\n—\n—\n\n\n\nOther Technician Aide HVB\n5\n(1.5%)\n5\n(1.5%)\n—\n—\n—\n—\n—\n—\n—\n—\n\n\n\nPharmacy Student Intern\n18\n(5.5%)\n18\n(5.5%)\n—\n—\n—\n—\n—\n—\n—\n—\n\n\n\nPharmacy Technician\n56\n(17.0%)\n55\n(16.7%)\n1\n(0.3%)\n—\n—\n—\n—\n—\n—\n\n\n\nPhlebotomist\n36\n(10.9%)\n36\n(10.9%)\n—\n—\n—\n—\n—\n—\n—\n—\n\n\n\nTelemetry Technician\n14\n(4.3%)\n14\n(4.3%)\n—\n—\n—\n—\n—\n—\n—\n—\n\n\nTotal, N\n—\n3094\n—\n1269\n—\n402\n—\n1305\n—\n111\n—\n7\n—",
    "crumbs": [
      "Project",
      "Data cleaning"
    ]
  },
  {
    "objectID": "01_data_cleaning.html#fte",
    "href": "01_data_cleaning.html#fte",
    "title": "Data cleaning",
    "section": "FTE",
    "text": "FTE\n\nCodefte_403b &lt;-\n  data_dc_403b |&gt; \n  left_join(data_ee_trim,\n            by = c(\"employment_id\" = \"ee_id\"))\n\nfte_pension &lt;-\n  data_db_pension |&gt; \n  left_join(data_ee_trim,\n            by = c(\"employment_id\" = \"ee_id\"))\n\ntbl_fte_403b &lt;-\n  fte_403b |&gt; \n  tbl_summary(include = c(fte),\n              type = all_continuous() ~ \"continuous2\",\n              statistic = all_continuous() ~ c(\n                \"{min}\",\n                \"{max}\"\n              ),\n              by = work_type_description) #|&gt; \n  # modify_caption(\"FTE among 403b employees\")\n\ntbl_fte_pension &lt;-\n  fte_pension |&gt; \n  tbl_summary(include = c(fte),\n              type = all_continuous() ~ \"continuous2\",\n              statistic = all_continuous() ~ c(\n                \"{min}\",\n                \"{max}\"\n              ),\n              by = work_type_description) #|&gt; \n  # modify_caption(\"FTE among pension employees\")\n\ntbl_stack(tbls = list(tbl_fte_403b, tbl_fte_pension),\n          group_header = c(\"403b\", \"Pension\")) |&gt; \n  modify_source_note('\"Unknown\" represents employees excluded from shared dataset') |&gt;\n  modify_header(all_stat_cols() ~ \"**{level}**&lt;br&gt;N = {n} ({style_percent(p)}%)\") |&gt;\n  as_gt() |&gt; \n  gt::cols_width(\n    label ~ px(90),\n    everything() ~ px(80)\n  ) |&gt; \n  gt::tab_header(title = \"FTE by Work Description\") |&gt; \n  gt::opt_vertical_padding(scale = 0.25) |&gt; \n  gt::opt_table_font(font = \"Avenir\", \n                     stack = \"rounded-sans\")\n\n\n\n\n\n\nFTE by Work Description\n\n\nCharacteristic\n\nFull-timeN = 2546 (79%)\n\nInvoluntaryN = 3 (&lt;0.1%)\n\nMD Full-timeN = 1 (&lt;0.1%)\n\nPart-time -19 hoursN = 17 (0.5%)\n\nPart-time 20+ hoursN = 265 (8.2%)\n\nPer DiemN = 384 (12%)\n\nVoluntaryN = 16 (0.5%)\n\n\n\n\n403b\n\n\nFTE\n\n\n\n\n\n\n\n\n\n    Min\n0.01\nInf\nInf\n0.01\n0.50\n0.01\nInf\n\n\n    Max\n1.01\n-Inf\n-Inf\n0.48\n0.80\n0.02\n-Inf\n\n\n    Unknown\n717\n3\n1\n1\n78\n47\n16\n\n\nPension\n\n\nFTE\n\n\n\n\n\n\n\n\n\n    Min\n0.88\n0.50\n0.01\n\n\n\n\n\n\n    Max\n1.01\n0.75\n0.01\n\n\n\n\n\n\n    Unknown\n95\n2\n6\n\n\n\n\n\n\n\n“Unknown” represents employees excluded from shared dataset",
    "crumbs": [
      "Project",
      "Data cleaning"
    ]
  },
  {
    "objectID": "01_data_cleaning.html#retirement-plans",
    "href": "01_data_cleaning.html#retirement-plans",
    "title": "Data cleaning",
    "section": "Retirement plans",
    "text": "Retirement plans\n403b\n\nCodedata_ee_pension_403b &lt;-\n  data_ee_trim |&gt; \n  mutate(flag_pension = if_else(ee_id %in% data_db_pension$employment_id, \"Yes\", \"No\"),\n         flag_pension = factor(flag_pension, levels = c(\"Yes\", \"No\")),\n         flag_403b = if_else(ee_id %in% data_dc_403b$employment_id, \"Yes\", \"No\"),\n         flag_403b = factor(flag_403b, levels = c(\"Yes\", \"No\"))) |&gt; \n  set_variable_labels(flag_pension = \"Pension plan\",\n                      flag_403b = \"403b Plan\")\n\ndata_ee_pension_403b |&gt; \n  tbl_summary(include = c(flag_pension,\n                          annual_salary_category,\n                          race_ethnicity,\n                          gender,\n                          job_category),\n              by = flag_403b,\n              percent = \"column\",\n              sort = list(job_category ~ \"frequency\")) |&gt; \n  add_overall() |&gt;\n  modify_header(all_stat_cols() ~ \"**{level}**&lt;br&gt;N = {n} ({style_percent(p)}%)\") |&gt;\n  as_gt() |&gt; \n  gt::cols_width(label ~ px(220),\n                 everything() ~ px(80)) |&gt; \n  gt::tab_header(title = \"Employees with 403b retirement plan\") |&gt; \n  gt::opt_vertical_padding(scale = 0.25) |&gt; \n  gt::opt_table_font(font = \"Avenir\", \n                     stack = \"rounded-sans\")\n\n\n\n\n\n\nEmployees with 403b retirement plan\n\n\nCharacteristic\n\nOverallN = 3094 (100%)1\n\n\nYesN = 2369 (77%)1\n\n\nNoN = 725 (23%)1\n\n\n\n\n\nPension plan\n389 (13%)\n0 (0%)\n389 (54%)\n\n\nAnnual salary category\n\n\n\n\n\n    Less than 62k\n1,269 (41%)\n921 (39%)\n348 (48%)\n\n\n    62k-100k\n402 (13%)\n302 (13%)\n100 (14%)\n\n\n    100k-150k\n1,305 (42%)\n1,054 (44%)\n251 (35%)\n\n\n    150k-200k\n111 (3.6%)\n90 (3.8%)\n21 (2.9%)\n\n\n    More than 200k\n7 (0.2%)\n2 (&lt;0.1%)\n5 (0.7%)\n\n\nRace/ethnicity\n\n\n\n\n\n    Amer Ind/Alask Ntv not His/Lat\n2 (0.2%)\n2 (0.3%)\n0 (0%)\n\n\n    Asian not Hispanic/Latino\n301 (32%)\n228 (31%)\n73 (35%)\n\n\n    Black/African Amer not His/Lat\n297 (31%)\n225 (30%)\n72 (35%)\n\n\n    Hispanic or Latino\n151 (16%)\n130 (18%)\n21 (10%)\n\n\n    Ntv Hawaii/Pac Isl not His/Lat\n4 (0.4%)\n4 (0.5%)\n0 (0%)\n\n\n    Two or More Races not Hisp/Lat\n88 (9.3%)\n68 (9.2%)\n20 (9.7%)\n\n\n    Undeclared\n49 (5.2%)\n37 (5.0%)\n12 (5.8%)\n\n\n    White not Hispanic/Latino\n53 (5.6%)\n44 (6.0%)\n9 (4.3%)\n\n\n    Unknown\n2,149\n1,631\n518\n\n\nGender\n\n\n\n\n\n    F\n2,427 (78%)\n1,881 (79%)\n546 (75%)\n\n\n    M\n651 (21%)\n475 (20%)\n176 (24%)\n\n\n    O\n1 (&lt;0.1%)\n0 (0%)\n1 (0.1%)\n\n\n    W\n15 (0.5%)\n13 (0.5%)\n2 (0.3%)\n\n\nJob category\n\n\n\n\n\n    Nursing RN Direct Pt Care\n1,229 (40%)\n1,007 (43%)\n222 (31%)\n\n\n    Nursing Support\n488 (16%)\n348 (15%)\n140 (19%)\n\n\n    Technician\n329 (11%)\n218 (9.2%)\n111 (15%)\n\n\n    Nursing Advanced Practice\n163 (5.3%)\n145 (6.1%)\n18 (2.5%)\n\n\n    AH Pharmacist\n107 (3.5%)\n92 (3.9%)\n15 (2.1%)\n\n\n    Access\n94 (3.0%)\n72 (3.0%)\n22 (3.0%)\n\n\n    Clerical and Other\n87 (2.8%)\n63 (2.7%)\n24 (3.3%)\n\n\n    Nursing RN Indirect Pt Care\n79 (2.6%)\n56 (2.4%)\n23 (3.2%)\n\n\n    AH Respiratory\n62 (2.0%)\n47 (2.0%)\n15 (2.1%)\n\n\n    AH Cardiology\n50 (1.6%)\n37 (1.6%)\n13 (1.8%)\n\n\n    AH Radiology Technologist-Spec\n49 (1.6%)\n34 (1.4%)\n15 (2.1%)\n\n\n    AH Radiology Technologist-Diag\n45 (1.5%)\n33 (1.4%)\n12 (1.7%)\n\n\n    Professional Clinical\n44 (1.4%)\n28 (1.2%)\n16 (2.2%)\n\n\n    AH Lab-Path Technologist\n43 (1.4%)\n31 (1.3%)\n12 (1.7%)\n\n\n    Nursing RN MD Office\n43 (1.4%)\n38 (1.6%)\n5 (0.7%)\n\n\n    Management Supervisor\n41 (1.3%)\n23 (1.0%)\n18 (2.5%)\n\n\n    Service\n37 (1.2%)\n28 (1.2%)\n9 (1.2%)\n\n\n    Management Middle and Upper\n27 (0.9%)\n20 (0.8%)\n7 (1.0%)\n\n\n    Professional Other\n24 (0.8%)\n16 (0.7%)\n8 (1.1%)\n\n\n    Management Nurse Manager\n23 (0.7%)\n17 (0.7%)\n6 (0.8%)\n\n\n    Management Nursing\n22 (0.7%)\n10 (0.4%)\n12 (1.7%)\n\n\n    Professional Finance\n4 (0.1%)\n3 (0.1%)\n1 (0.1%)\n\n\n    AH Rad-Onc Cancer Professional\n2 (&lt;0.1%)\n2 (&lt;0.1%)\n0 (0%)\n\n\n    AH PT OT SP Therapist\n1 (&lt;0.1%)\n1 (&lt;0.1%)\n0 (0%)\n\n\n    Professional Info Tech\n1 (&lt;0.1%)\n0 (0%)\n1 (0.1%)\n\n\n\n\n1 n (%)\n\n\n\n\n\nPension\n\nCodedata_ee_pension_403b |&gt; \n  tbl_summary(include = c(flag_403b,\n                          annual_salary_category,\n                          race_ethnicity,\n                          gender,\n                          job_category),\n              by = flag_pension,\n              percent = \"column\",\n              sort = list(job_category ~ \"frequency\")) |&gt; \n  add_overall() |&gt;\n  modify_header(all_stat_cols() ~ \"**{level}**&lt;br&gt;N = {n} ({style_percent(p)}%)\") |&gt;\n  as_gt() |&gt; \n  gt::cols_width(label ~ px(220),\n                 everything() ~ px(80)) |&gt; \n  gt::tab_header(title = \"Employees with pension plan\") |&gt; \n  gt::opt_vertical_padding(scale = 0.25) |&gt; \n  gt::opt_table_font(font = \"Avenir\", \n                     stack = \"rounded-sans\")\n\n\n\n\n\n\nEmployees with pension plan\n\n\nCharacteristic\n\nOverallN = 3094 (100%)1\n\n\nYesN = 389 (13%)1\n\n\nNoN = 2705 (87%)1\n\n\n\n\n\n403b Plan\n2,369 (77%)\n0 (0%)\n2,369 (88%)\n\n\nAnnual salary category\n\n\n\n\n\n    Less than 62k\n1,269 (41%)\n106 (27%)\n1,163 (43%)\n\n\n    62k-100k\n402 (13%)\n70 (18%)\n332 (12%)\n\n\n    100k-150k\n1,305 (42%)\n188 (48%)\n1,117 (41%)\n\n\n    150k-200k\n111 (3.6%)\n20 (5.1%)\n91 (3.4%)\n\n\n    More than 200k\n7 (0.2%)\n5 (1.3%)\n2 (&lt;0.1%)\n\n\nRace/ethnicity\n\n\n\n\n\n    Amer Ind/Alask Ntv not His/Lat\n2 (0.2%)\n0 (0%)\n2 (0.2%)\n\n\n    Asian not Hispanic/Latino\n301 (32%)\n33 (40%)\n268 (31%)\n\n\n    Black/African Amer not His/Lat\n297 (31%)\n29 (35%)\n268 (31%)\n\n\n    Hispanic or Latino\n151 (16%)\n6 (7.2%)\n145 (17%)\n\n\n    Ntv Hawaii/Pac Isl not His/Lat\n4 (0.4%)\n0 (0%)\n4 (0.5%)\n\n\n    Two or More Races not Hisp/Lat\n88 (9.3%)\n9 (11%)\n79 (9.2%)\n\n\n    Undeclared\n49 (5.2%)\n2 (2.4%)\n47 (5.5%)\n\n\n    White not Hispanic/Latino\n53 (5.6%)\n4 (4.8%)\n49 (5.7%)\n\n\n    Unknown\n2,149\n306\n1,843\n\n\nGender\n\n\n\n\n\n    F\n2,427 (78%)\n317 (81%)\n2,110 (78%)\n\n\n    M\n651 (21%)\n72 (19%)\n579 (21%)\n\n\n    O\n1 (&lt;0.1%)\n0 (0%)\n1 (&lt;0.1%)\n\n\n    W\n15 (0.5%)\n0 (0%)\n15 (0.6%)\n\n\nJob category\n\n\n\n\n\n    Nursing RN Direct Pt Care\n1,229 (40%)\n145 (37%)\n1,084 (40%)\n\n\n    Nursing Support\n488 (16%)\n50 (13%)\n438 (16%)\n\n\n    Technician\n329 (11%)\n32 (8.2%)\n297 (11%)\n\n\n    Nursing Advanced Practice\n163 (5.3%)\n14 (3.6%)\n149 (5.5%)\n\n\n    AH Pharmacist\n107 (3.5%)\n11 (2.8%)\n96 (3.5%)\n\n\n    Access\n94 (3.0%)\n12 (3.1%)\n82 (3.0%)\n\n\n    Clerical and Other\n87 (2.8%)\n13 (3.3%)\n74 (2.7%)\n\n\n    Nursing RN Indirect Pt Care\n79 (2.6%)\n16 (4.1%)\n63 (2.3%)\n\n\n    AH Respiratory\n62 (2.0%)\n10 (2.6%)\n52 (1.9%)\n\n\n    AH Cardiology\n50 (1.6%)\n6 (1.5%)\n44 (1.6%)\n\n\n    AH Radiology Technologist-Spec\n49 (1.6%)\n11 (2.8%)\n38 (1.4%)\n\n\n    AH Radiology Technologist-Diag\n45 (1.5%)\n10 (2.6%)\n35 (1.3%)\n\n\n    Professional Clinical\n44 (1.4%)\n5 (1.3%)\n39 (1.4%)\n\n\n    AH Lab-Path Technologist\n43 (1.4%)\n7 (1.8%)\n36 (1.3%)\n\n\n    Nursing RN MD Office\n43 (1.4%)\n4 (1.0%)\n39 (1.4%)\n\n\n    Management Supervisor\n41 (1.3%)\n14 (3.6%)\n27 (1.0%)\n\n\n    Service\n37 (1.2%)\n0 (0%)\n37 (1.4%)\n\n\n    Management Middle and Upper\n27 (0.9%)\n5 (1.3%)\n22 (0.8%)\n\n\n    Professional Other\n24 (0.8%)\n6 (1.5%)\n18 (0.7%)\n\n\n    Management Nurse Manager\n23 (0.7%)\n5 (1.3%)\n18 (0.7%)\n\n\n    Management Nursing\n22 (0.7%)\n11 (2.8%)\n11 (0.4%)\n\n\n    Professional Finance\n4 (0.1%)\n1 (0.3%)\n3 (0.1%)\n\n\n    AH Rad-Onc Cancer Professional\n2 (&lt;0.1%)\n0 (0%)\n2 (&lt;0.1%)\n\n\n    AH PT OT SP Therapist\n1 (&lt;0.1%)\n0 (0%)\n1 (&lt;0.1%)\n\n\n    Professional Info Tech\n1 (&lt;0.1%)\n1 (0.3%)\n0 (0%)\n\n\n\n\n1 n (%)",
    "crumbs": [
      "Project",
      "Data cleaning"
    ]
  },
  {
    "objectID": "01_data_cleaning.html#retirement-loans",
    "href": "01_data_cleaning.html#retirement-loans",
    "title": "Data cleaning",
    "section": "Retirement loans",
    "text": "Retirement loans\n\nCodesummary_retirement_loans &lt;-\n  data_retirement_loans |&gt; \n  clean_names() |&gt; \n  group_by(employment_id) |&gt; \n  mutate(n_loans = n()) |&gt; \n  set_variable_labels(description = \"Loan description\")\n\ndata_ee_loans &lt;-\n  data_ee_trim |&gt; \n  left_join(summary_retirement_loans, by = c(\"ee_id\" = \"employment_id\"))\n\ndata_ee_loans |&gt; \n  tbl_summary(include = c(n_loans,\n                          description,\n                          annual_salary_category,\n                          race_ethnicity,\n                          gender,\n                          job_category),\n              by = n_loans,\n              sort = list(description ~ \"alphanumeric\")) |&gt; \n  add_overall() |&gt;\n  modify_header(all_stat_cols() ~ \"**{level}**&lt;br&gt;N = {n} ({style_percent(p)}%)\") |&gt;\n  as_gt() |&gt; \n  gt::cols_width(label ~ px(220),\n                 everything() ~ px(80)) |&gt; \n  gt::tab_header(title = \"Number of retirement loans\") |&gt;\n  gt::opt_vertical_padding(scale = 0.25) |&gt; \n  gt::opt_table_font(font = \"Avenir\", \n                     stack = \"rounded-sans\")\n\n\n\n\n\n\nNumber of retirement loans\n\n\nCharacteristic\n\nOverallN = 626 (100%)1\n\n\n1N = 240 (38%)1\n\n\n2N = 386 (62%)1\n\n\n\n\n\nLoan description\n\n\n\n\n\n    401(k) Fidelity Loan 03\n4 (0.6%)\n1 (0.4%)\n3 (0.8%)\n\n\n    401(k) Fidelity Loan 04\n3 (0.5%)\n0 (0%)\n3 (0.8%)\n\n\n    403(b) Fidelity Loan 01\n400 (64%)\n210 (88%)\n190 (49%)\n\n\n    403(b) Fidelity Loan 02\n219 (35%)\n29 (12%)\n190 (49%)\n\n\nAnnual salary category\n\n\n\n\n\n    Less than 62k\n270 (43%)\n96 (40%)\n174 (45%)\n\n\n    62k-100k\n98 (16%)\n32 (13%)\n66 (17%)\n\n\n    100k-150k\n234 (37%)\n100 (42%)\n134 (35%)\n\n\n    150k-200k\n23 (3.7%)\n11 (4.6%)\n12 (3.1%)\n\n\n    More than 200k\n1 (0.2%)\n1 (0.4%)\n0 (0%)\n\n\nRace/ethnicity\n\n\n\n\n\n    Asian not Hispanic/Latino\n51 (25%)\n19 (23%)\n32 (27%)\n\n\n    Black/African Amer not His/Lat\n101 (50%)\n39 (46%)\n62 (52%)\n\n\n    Hispanic or Latino\n19 (9.3%)\n13 (15%)\n6 (5.0%)\n\n\n    Two or More Races not Hisp/Lat\n18 (8.8%)\n10 (12%)\n8 (6.7%)\n\n\n    Undeclared\n5 (2.5%)\n1 (1.2%)\n4 (3.3%)\n\n\n    White not Hispanic/Latino\n10 (4.9%)\n2 (2.4%)\n8 (6.7%)\n\n\n    Unknown\n422\n156\n266\n\n\nGender\n\n\n\n\n\n    F\n497 (79%)\n193 (80%)\n304 (79%)\n\n\n    M\n129 (21%)\n47 (20%)\n82 (21%)\n\n\nJob category\n\n\n\n\n\n    Access\n17 (2.7%)\n9 (3.8%)\n8 (2.1%)\n\n\n    AH Cardiology\n8 (1.3%)\n4 (1.7%)\n4 (1.0%)\n\n\n    AH Lab-Path Technologist\n5 (0.8%)\n3 (1.3%)\n2 (0.5%)\n\n\n    AH Pharmacist\n3 (0.5%)\n1 (0.4%)\n2 (0.5%)\n\n\n    AH Radiology Technologist-Diag\n12 (1.9%)\n4 (1.7%)\n8 (2.1%)\n\n\n    AH Radiology Technologist-Spec\n12 (1.9%)\n6 (2.5%)\n6 (1.6%)\n\n\n    AH Respiratory\n15 (2.4%)\n7 (2.9%)\n8 (2.1%)\n\n\n    Clerical and Other\n30 (4.8%)\n10 (4.2%)\n20 (5.2%)\n\n\n    Management Middle and Upper\n16 (2.6%)\n2 (0.8%)\n14 (3.6%)\n\n\n    Management Nurse Manager\n15 (2.4%)\n5 (2.1%)\n10 (2.6%)\n\n\n    Management Nursing\n2 (0.3%)\n2 (0.8%)\n0 (0%)\n\n\n    Management Supervisor\n15 (2.4%)\n5 (2.1%)\n10 (2.6%)\n\n\n    Nursing Advanced Practice\n17 (2.7%)\n7 (2.9%)\n10 (2.6%)\n\n\n    Nursing RN Direct Pt Care\n200 (32%)\n88 (37%)\n112 (29%)\n\n\n    Nursing RN Indirect Pt Care\n19 (3.0%)\n11 (4.6%)\n8 (2.1%)\n\n\n    Nursing RN MD Office\n4 (0.6%)\n4 (1.7%)\n0 (0%)\n\n\n    Nursing Support\n146 (23%)\n46 (19%)\n100 (26%)\n\n\n    Professional Clinical\n8 (1.3%)\n2 (0.8%)\n6 (1.6%)\n\n\n    Professional Finance\n2 (0.3%)\n0 (0%)\n2 (0.5%)\n\n\n    Professional Other\n8 (1.3%)\n2 (0.8%)\n6 (1.6%)\n\n\n    Service\n8 (1.3%)\n0 (0%)\n8 (2.1%)\n\n\n    Technician\n64 (10%)\n22 (9.2%)\n42 (11%)\n\n\n\n\n1 n (%)",
    "crumbs": [
      "Project",
      "Data cleaning"
    ]
  },
  {
    "objectID": "01_data_cleaning.html#employee-location",
    "href": "01_data_cleaning.html#employee-location",
    "title": "Data cleaning",
    "section": "Employee location",
    "text": "Employee location\nWork vs. home zip codes\n\nCodedata_ee_location &lt;-\n  data_ee_trim |&gt;\n  mutate(work_zip_code_short = str_remove(work_zip_code, pattern = \"\\\\-[0-9]{4}\"),\n         zip_code_short = str_remove(zip_code, pattern = \"\\\\-[0-9]{4}\")) |&gt; \n  mutate(flag_work_and_home = if_else(work_zip_code_short == zip_code_short, \"Yes\", \"No\"),\n         flag_work_and_home = factor(flag_work_and_home,\n                                     levels = c(\"Yes\", \"No\"))) |&gt; \n  set_variable_labels(flag_work_and_home = \"Same zip for work and home\",\n                      work_zip_code_short = \"Work zip code\",\n                      zip_code_short = \"Home zip code\")\n\ndata_ee_location |&gt; \n  tbl_summary(include = c(flag_work_and_home,\n                          annual_salary_category,\n                          race_ethnicity,\n                          gender,\n                          job_category),\n              by = flag_work_and_home) |&gt; \n  add_overall() |&gt;\n  modify_header(all_stat_cols() ~ \"**{level}**&lt;br&gt;N = {n} ({style_percent(p)}%)\") |&gt; \n  as_gt() |&gt;\n  gt::cols_width(label ~ px(220),\n                 everything() ~ px(80)) |&gt; \n  gt::tab_header(\"Employees work in the zip code they live in\") |&gt; \n  gt::opt_vertical_padding(scale = 0.2) |&gt; \n  gt::opt_table_font(font = \"Avenir\",\n                     stack = \"rounded-sans\")\n\n\n\n\n\n\nEmployees work in the zip code they live in\n\n\nCharacteristic\n\nOverallN = 3094 (100%)1\n\n\nYesN = 107 (3.5%)1\n\n\nNoN = 2987 (97%)1\n\n\n\n\n\nAnnual salary category\n\n\n\n\n\n    Less than 62k\n1,269 (41%)\n57 (53%)\n1,212 (41%)\n\n\n    62k-100k\n402 (13%)\n17 (16%)\n385 (13%)\n\n\n    100k-150k\n1,305 (42%)\n32 (30%)\n1,273 (43%)\n\n\n    150k-200k\n111 (3.6%)\n1 (0.9%)\n110 (3.7%)\n\n\n    More than 200k\n7 (0.2%)\n0 (0%)\n7 (0.2%)\n\n\nRace/ethnicity\n\n\n\n\n\n    Amer Ind/Alask Ntv not His/Lat\n2 (0.2%)\n0 (0%)\n2 (0.2%)\n\n\n    Asian not Hispanic/Latino\n301 (32%)\n14 (33%)\n287 (32%)\n\n\n    Black/African Amer not His/Lat\n297 (31%)\n9 (21%)\n288 (32%)\n\n\n    Hispanic or Latino\n151 (16%)\n16 (37%)\n135 (15%)\n\n\n    Ntv Hawaii/Pac Isl not His/Lat\n4 (0.4%)\n0 (0%)\n4 (0.4%)\n\n\n    Two or More Races not Hisp/Lat\n88 (9.3%)\n3 (7.0%)\n85 (9.4%)\n\n\n    Undeclared\n49 (5.2%)\n1 (2.3%)\n48 (5.3%)\n\n\n    White not Hispanic/Latino\n53 (5.6%)\n0 (0%)\n53 (5.9%)\n\n\n    Unknown\n2,149\n64\n2,085\n\n\nGender\n\n\n\n\n\n    F\n2,427 (78%)\n73 (68%)\n2,354 (79%)\n\n\n    M\n651 (21%)\n32 (30%)\n619 (21%)\n\n\n    O\n1 (&lt;0.1%)\n0 (0%)\n1 (&lt;0.1%)\n\n\n    W\n15 (0.5%)\n2 (1.9%)\n13 (0.4%)\n\n\nJob category\n\n\n\n\n\n    Access\n94 (3.0%)\n4 (3.7%)\n90 (3.0%)\n\n\n    AH Cardiology\n50 (1.6%)\n2 (1.9%)\n48 (1.6%)\n\n\n    AH Lab-Path Technologist\n43 (1.4%)\n1 (0.9%)\n42 (1.4%)\n\n\n    AH Pharmacist\n107 (3.5%)\n3 (2.8%)\n104 (3.5%)\n\n\n    AH PT OT SP Therapist\n1 (&lt;0.1%)\n0 (0%)\n1 (&lt;0.1%)\n\n\n    AH Rad-Onc Cancer Professional\n2 (&lt;0.1%)\n0 (0%)\n2 (&lt;0.1%)\n\n\n    AH Radiology Technologist-Diag\n45 (1.5%)\n0 (0%)\n45 (1.5%)\n\n\n    AH Radiology Technologist-Spec\n49 (1.6%)\n0 (0%)\n49 (1.6%)\n\n\n    AH Respiratory\n62 (2.0%)\n1 (0.9%)\n61 (2.0%)\n\n\n    Clerical and Other\n87 (2.8%)\n0 (0%)\n87 (2.9%)\n\n\n    Management Middle and Upper\n27 (0.9%)\n1 (0.9%)\n26 (0.9%)\n\n\n    Management Nurse Manager\n23 (0.7%)\n0 (0%)\n23 (0.8%)\n\n\n    Management Nursing\n22 (0.7%)\n1 (0.9%)\n21 (0.7%)\n\n\n    Management Supervisor\n41 (1.3%)\n3 (2.8%)\n38 (1.3%)\n\n\n    Nursing Advanced Practice\n163 (5.3%)\n2 (1.9%)\n161 (5.4%)\n\n\n    Nursing RN Direct Pt Care\n1,229 (40%)\n35 (33%)\n1,194 (40%)\n\n\n    Nursing RN Indirect Pt Care\n79 (2.6%)\n2 (1.9%)\n77 (2.6%)\n\n\n    Nursing RN MD Office\n43 (1.4%)\n3 (2.8%)\n40 (1.3%)\n\n\n    Nursing Support\n488 (16%)\n28 (26%)\n460 (15%)\n\n\n    Professional Clinical\n44 (1.4%)\n4 (3.7%)\n40 (1.3%)\n\n\n    Professional Finance\n4 (0.1%)\n0 (0%)\n4 (0.1%)\n\n\n    Professional Info Tech\n1 (&lt;0.1%)\n0 (0%)\n1 (&lt;0.1%)\n\n\n    Professional Other\n24 (0.8%)\n2 (1.9%)\n22 (0.7%)\n\n\n    Service\n37 (1.2%)\n1 (0.9%)\n36 (1.2%)\n\n\n    Technician\n329 (11%)\n14 (13%)\n315 (11%)\n\n\n\n\n1 n (%)\n\n\n\n\n\n\nCodesummary_zip_codes &lt;-\n  data_ee_location |&gt; \n  group_by(zip_code_short) |&gt; \n  mutate(n_zip_code = n_distinct(ee_id),\n         n_zip_code = as.numeric(n_zip_code)) |&gt; \n  group_by(zip_code_short, n_zip_code, annual_salary_category) |&gt; \n  summarize(n_salary_category = n_distinct(ee_id),\n            prop_salary_category = n_salary_category/n_zip_code) |&gt; \n  arrange(desc(n_zip_code)) |&gt; \n  unique() |&gt; \n  ungroup() |&gt; \n  mutate(n_zip_code_cat = cut(\n      n_zip_code,\n      breaks = seq(0, 100, by = 20),\n      labels = c(\"0-20\", \"20-40\", \"40-60\", \"60-80\", \"80-100\"),\n      include.lowest = TRUE,\n      right = TRUE),\n      .after = n_zip_code\n      ) |&gt; \n  set_variable_labels(zip_code_short = \"Zip code\",\n                      n_zip_code = \"Number in zip code\",\n                      n_zip_code_cat = \"Number in zip code\")\n\n\nHome zip code & salary\n\nCodedata_ee_location |&gt; \n  tbl_summary(include = c(zip_code_short,\n                          annual_salary_category),\n              by = annual_salary_category,\n              sort = zip_code_short ~ \"frequency\") |&gt; \n  add_overall() |&gt; \n  modify_header(all_stat_cols() ~ \"**{level}**&lt;br&gt;N = {n} ({style_percent(p)}%)\") |&gt; \n  as_gt() |&gt;\n  gt::cols_width(label ~ px(100),\n                 everything() ~ px(80)) |&gt; \n  gt::tab_header(\"Employee home zip code and salary categories\") |&gt; \n  gt::opt_vertical_padding(scale = 0.25) |&gt; \n  gt::opt_table_font(font = \"Avenir\",\n                     stack = \"rounded-sans\") |&gt; \n  gt::opt_interactive(page_size_default = 20,\n                      use_compact_mode = TRUE,\n                      use_search = TRUE)\n\n\n\n\nEmployee home zip code and salary categories\n\n\n\n\n\n\n\n\n1 n (%)\n\n\n\n\n\n\n\nCodesf_zips &lt;-\n  zips |&gt;\n  select(CODE) |&gt; \n  left_join(summary_zip_codes, \n            by = c(\"CODE\" = \"zip_code_short\"), \n            keep = TRUE) |&gt; \n  select(-CODE)\n\n# mapgl::maplibre_view(\n#   data = sf_zips,\n#   column = \"n_zip_code\"\n# )\n\n\nMap\n\nCodemapbox_access_token()\n\n\n\nCodemap_zip_codes &lt;-\n  rdeck(map_style = mapbox_light(),\n      initial_view_state = view_state(\n        center = c(-75.14873, 39.99692),\n        zoom = 9.5\n      )) |&gt; \n  # add unseen schools ----\n  add_polygon_layer(\n    data = sf_zips, \n    name = \"Number of employees\\nin zip code\",\n    get_polygon = geom,\n    get_line_color = \"#FFFFFF\",\n    get_line_width = 0.25,\n    line_width_units = \"pixels\",\n    stroked = TRUE,\n    filled = TRUE,\n    # get_fill_color = scale_color_linear(\n    #   col = \"n_zip_code\",\n    #   palette = scales::viridis_pal()),\n    get_fill_color =  scale_color_category(\n      col = \"n_zip_code_cat\",\n      palette = scales::viridis_pal(),\n      col_label = \"Number in zip code\"\n    ),\n    line_width_scale = 5,\n    # line_width_min_pixels = 5,\n    # line_width_max_pixels = 30,\n    auto_highlight = TRUE,\n    highlight_color = \"#e69138\", # ffd966 yellow\n    visible = TRUE,\n    pickable = TRUE,\n    tooltip = c(zip_code_short, n_zip_code)\n  )\nmap_zip_codes\n\n\n\n\nCodehtmlwidgets::saveWidget(\n  widget = map_zip_codes,\n  title = \"Number of employees in zip code\",\n  file = here::here(\"data\", \"map_zip_codes.html\"),\n  selfcontained = TRUE\n)",
    "crumbs": [
      "Project",
      "Data cleaning"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "PPMC Human Resources Data",
    "section": "",
    "text": "This project explores Penn Presbyterian Medical Center (PPMC) employee use of benefits."
  }
]